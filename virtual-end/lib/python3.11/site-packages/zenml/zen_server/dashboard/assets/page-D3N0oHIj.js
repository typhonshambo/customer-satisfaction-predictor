import{j as s,e as D}from"./@tanstack-D1KSn3AD.js";import{U as E,V as k,h as f,W as z,X as M,Y as A,f as v,a2 as P,i as b,I as o,a0 as T,a1 as B,z as a,ag as L,B as V,S as C,A as q,b as Q,af as R}from"./index-mCzH7qVB.js";import{u as S}from"./update-current-user-mutation-BkdKNriO.js";import{r as l}from"./@radix-Mqgm9uyP.js";import{u as F}from"./index.esm-5yOGu3_l.js";import{t as U}from"./zod-DWNKqVmj.js";import{P as Z}from"./PasswordChecker-DozYDv4b.js";import{u as _}from"./UpdatePasswordSchemas-DWVN5Ejn.js";import{D as K}from"./DisplayDate-xz7bjv92.js";import"./@react-router-t1nY6c48.js";import"./@reactflow-D76xjDUs.js";const O=e=>l.createElement("svg",{viewBox:"0 0 56 56",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M28 5.5C15.5736 5.5 5.5 15.5736 5.5 28C5.5 40.4264 15.5736 50.5 28 50.5C40.4264 50.5 50.5 40.4264 50.5 28C50.5 15.5736 40.4264 5.5 28 5.5ZM0.5 28C0.5 12.8122 12.8122 0.5 28 0.5C43.1878 0.5 55.5 12.8122 55.5 28C55.5 43.1878 43.1878 55.5 28 55.5C12.8122 55.5 0.5 43.1878 0.5 28ZM41.0178 18.7322C41.9941 19.7085 41.9941 21.2915 41.0178 22.2678L26.0178 37.2678C25.0415 38.2441 23.4585 38.2441 22.4822 37.2678L14.9822 29.7678C14.0059 28.7915 14.0059 27.2085 14.9822 26.2322C15.9585 25.2559 17.5415 25.2559 18.5178 26.2322L24.25 31.9645L37.4822 18.7322C38.4585 17.7559 40.0415 17.7559 41.0178 18.7322Z"}));function H(){const[e,t]=l.useState(!1);return s.jsxs(E,{onOpenChange:()=>{t(!1)},children:[s.jsx(k,{asChild:!0,children:s.jsx(f,{size:"md",className:"shrink-0",intent:"primary",emphasis:"subtle",children:"Change Password"})}),s.jsxs(z,{children:[s.jsx(M,{children:s.jsx(A,{children:" Update Credentials"})}),e?s.jsx(X,{}):s.jsx(W,{setSuccess:t})]})]})}function W({setSuccess:e}){var u;const t=l.useId(),n=l.useId(),d=l.useId(),{toast:x}=v(),{mutate:p,isPending:j}=S({onSuccess(){e(!0)},onError(i){P(i)&&x({status:"error",emphasis:"subtle",icon:s.jsx(b,{className:"h-5 w-5 shrink-0 fill-error-700"}),description:i.message,rounded:!0})}}),{register:c,handleSubmit:m,watch:w,formState:{isValid:N,errors:g}}=F({resolver:U(_),mode:"onChange",criteriaMode:"all"});function y(i){p({old_password:i.oldPassword,password:i.newPassword})}const h=(u=g.newPassword)==null?void 0:u.types;return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-5 p-7",children:[s.jsx("form",{id:"update-password-form",onSubmit:m(y),children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"space-y-0.5",children:[s.jsx("label",{htmlFor:t,className:"text-text-sm",children:"Old Password"}),s.jsx(o,{...c("oldPassword"),type:"password",id:t,className:"w-full"})]}),s.jsxs("div",{className:"space-y-0.5",children:[s.jsx("label",{htmlFor:n,className:"text-text-sm",children:"New Password"}),s.jsx(o,{...c("newPassword"),type:"password",id:n,className:"w-full"})]}),s.jsxs("div",{className:"space-y-0.5",children:[s.jsx("label",{htmlFor:d,className:"text-text-sm",children:"Confirm Password"}),s.jsx(o,{...c("confirmPassword"),type:"password",id:d,className:"w-full"})]})]})}),s.jsx(Z,{val:w("newPassword"),errors:h||[]})]}),s.jsxs(T,{className:"gap-[10px]",children:[s.jsx(B,{asChild:!0,children:s.jsx(f,{size:"sm",intent:"secondary",children:"Cancel"})}),s.jsx(f,{disabled:!N||j,form:"update-password-form",size:"sm",children:"Update Password"})]})]})}function X(){return s.jsxs("div",{className:"space-y-5 p-7 text-center",children:[s.jsx(O,{className:"mx-auto h-[110px] w-[110px] fill-success-500"}),s.jsx("p",{className:"text-text-lg font-semibold text-theme-text-primary",children:"The password was updated successfully!"})]})}const Y=a.object({fullName:a.union([a.string(),a.literal("")]),username:a.union([a.string(),a.literal("")]),email:a.union([a.string().email(),a.literal("")])}).refine(e=>e.fullName!==""||e.username!==""||e.email!=="");function G({user:e}){var h,u,i;const t=D(),{toast:n}=v(),d=l.useId(),x=l.useId(),p=l.useId(),{isPending:j,mutate:c}=S({onError(r){P(r)&&n({status:"error",emphasis:"subtle",icon:s.jsx(b,{className:"h-5 w-5 shrink-0 fill-error-700"}),description:r.message,rounded:!0})},onSuccess:()=>{t.invalidateQueries({queryKey:["current-user"]}),t.invalidateQueries({queryKey:["users"]}),w(),n({status:"success",emphasis:"subtle",rounded:!0,description:"User updated successfully"})}}),{register:m,reset:w,handleSubmit:N,formState:{isValid:g}}=F({resolver:U(Y),defaultValues:{email:void 0,fullName:void 0,username:void 0}});function y(r){const I={...r.fullName&&{full_name:r.fullName},...r.username&&{name:r.username},...r.email&&{email:r.email}};c(I)}return s.jsxs("div",{className:"w-full max-w-[600px]",children:[s.jsx("form",{onSubmit:N(y),children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"space-y-0.5",children:[s.jsx("label",{htmlFor:d,className:"text-text-sm",children:"Full Name"}),s.jsx(o,{placeholder:(h=e.body)==null?void 0:h.full_name,...m("fullName"),id:d,className:"w-full"})]}),s.jsxs("div",{className:"space-y-0.5",children:[s.jsx("label",{htmlFor:x,className:"text-text-sm",children:"Username"}),s.jsx(o,{...m("username"),placeholder:e.name,id:x,className:"w-full"})]}),s.jsxs("div",{className:"space-y-0.5",children:[s.jsx("label",{htmlFor:p,className:"text-text-sm",children:"Email"}),s.jsx(o,{placeholder:(u=e.metadata)==null?void 0:u.email,...m("email"),id:p,className:"w-full"})]}),s.jsx("div",{className:"flex justify-end",children:s.jsx(f,{disabled:j||!g,size:"md",intent:"primary",children:"Update"})})]})}),s.jsx(H,{}),s.jsxs("p",{className:"mt-5 text-text-sm text-theme-text-secondary",children:["Created on ",s.jsx(K,{dateString:((i=e.body)==null?void 0:i.created)||""})]})]})}function ds(){const{data:e}=L();return s.jsxs(V,{className:"flex flex-col gap-5 p-5",children:[s.jsx("h1",{className:"text-text-xl font-semibold",children:"Profile"}),s.jsxs("div",{className:"flex justify-between",children:[e?s.jsx(G,{user:e}):s.jsx(C,{className:"h-[350px] w-full"}),e?s.jsx(q,{size:"xxl",className:"ml-5 h-[140px] w-[140px]",type:"rounded",children:s.jsx(Q,{className:"text-display-lg",size:"xxl",children:R(e)[0]})}):s.jsx(C,{className:"h-[140px] w-[140px] rounded-rounded"})]})]})}export{ds as default};
